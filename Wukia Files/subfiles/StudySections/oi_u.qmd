## \textgreek{οι}/\textgreek{υ}

```{r Find_oi_data}
### oi / y ----------------------------------------------------------# Important Note on oi 
# Boeotian dat sg -οι from -ωι 
# Dosuna, 469

## OIKIA - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Read in assigned data
Data.oi.oikia <- read_csv(
  "~/Documents/UGA/Thesis/Wukia/data/Data.oi.oikia.CONF.csv",
  col_types = cols(
    ig_book = col_factor(levels = c()),
    ig_no = col_factor(levels = c()),
    location = col_factor(levels = c()),
    token = col_factor(levels = c()),
    data_type = col_factor(levels = c()),
    simplex = col_logical()
  )
)

# Remove erroneous captures
Data.oi.oikia <- Data.oi.oikia[!is.na(Data.oi.oikia$data_type),]

# Drop unused levels
Data.oi.oikia <- droplevels(Data.oi.oikia)

## AUTOS - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - # Read in assigned data
Data.oi.autos <- read_csv(
  "~/Documents/UGA/Thesis/Wukia/data/Data.oi.autos.CONF.csv",
  col_types = cols(
    ig_book = col_factor(levels = c()),
    ig_no = col_factor(levels = c()),
    location = col_factor(levels = c()),
    token = col_factor(levels = c()),
    data_type = col_factor(levels = c()),
    simplex = col_logical()
  )
)

# Remove erroneous captures
Data.oi.autos <- Data.oi.autos[!is.na(Data.oi.autos$data_type),]

## DHMOS - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - # Read in assigned data
Data.oi.dhmos <- read_csv(
  "~/Documents/UGA/Thesis/Wukia/data/Data.oi.dhmos.CONF.csv",
  col_types = cols(
    ig_book = col_factor(levels = c()),
    ig_no = col_factor(levels = c()),
    location = col_factor(levels = c()),
    token = col_factor(levels = c()),
    data_type = col_factor(levels = c()),
    simplex = col_logical()
  )
)

# Remove erroneous captures
Data.oi.dhmos <- Data.oi.dhmos[!is.na(Data.oi.dhmos$data_type),]

## O - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - # Read in assigned data
Data.oi.o <- read_csv(
  "~/Documents/UGA/Thesis/Wukia/data/Data.oi.o.CONF.csv",
  col_types = cols(
    ig_book = col_factor(levels = c()),
    ig_no = col_factor(levels = c()),
    location = col_factor(levels = c()),
    token = col_factor(levels = c()),
    data_type = col_factor(levels = c()),
    simplex = col_logical()
  )
)

# Remove erroneous captures
Data.oi.o <- Data.oi.o[!is.na(Data.oi.o$data_type),]

# Remove erroneous captures
Data.oi.o <- Data.oi.o[!is.na(Data.oi.o$data_type),]

# Final cleanup (extraneous capture)
# RegEx captured τυ as a fragment of τύχη
Data.oi.o <- Data.oi.o[-37,]
Data.oi.o <- Data.oi.o[-166,]

# RegEx captured τοι from, maybe, τοῖς
Data.oi.o <- Data.oi.o[-915,]


# COMBINED ...........................................................
# Combine all assigned data tables
Data.oi <- Data.oi.oikia %>%
  full_join(Data.oi.o) %>%
  full_join(Data.oi.dhmos) %>%
  full_join(Data.oi.autos)

# Remove ωι
Data.oi <- Data.oi[Data.oi$data_type != "ωι",]

# Remove fragments τοι
Data.oi <- Data.oi %>%
  filter((
    str_detect(location, "(Athens|Eleusis)") == T &
      str_detect(token, "^τοι$") == T
  ) == F)

# Remove δήμοι for δήμωι
Data.oi <- Data.oi[-602,]

# Drop unused levels
Data.oi <- droplevels(Data.oi)
```

The \textgreek{οι}/\textgreek{υ} isogloss is represented by the first syllable of the noun \textgreek{(ϝ)οικία} 'home', as well as the o-stem endings with the diphthong \textgreek{-οι-} as seen on instances of the noun \textgreek{δῆμος/δᾶμος} 'deme', the definite article \textgreek{ὁ}, and the pronoun \textgreek{αὐτός}. The inscriptions DGE 459.1-.3, all Tanagran proxeny inscriptions which conveyed legal privileges on their \textgreek{πρόξενοι} 'public friends, foreign benefactors' and were carved on the same stone at various points in the 3rd cent.\ BCE, show cooccurrences of the monophthong \textgreek{υ} and diphthong \textgreek{οι}. DGE 459.1 contains the monophthongized \textgreek{ϝυκίας} alongside the dative singular \textgreek{τοῖ δάμοι} and dative plural \textgreek{αὐτοῖς}, both of which occur again in DGE 459.3. Similarly, DGE 459.2 contains the singular \textgreek{τοῖ δάμοι} alongside the singular \textgreek{αὐτοῖ}. Furthermore, the roughly-contemporary Tanagran proxeny decrees of DGE 460.1 and .2 demonstrate complete monophthongization, with each containing instances of \textgreek{ϝυκίας}, \textgreek{τῦ δάμυ}, and \textgreek{αὐτῦς}. The cooccurrence of the innovative monophthong \textgreek{υ} and the diphthong \textgreek{οι} brings into question the timing and completeness of the \textgreek{οι} \> \textgreek{υ} shift, as well as its geographical extent. Therefore, the author collected instances of the relevant forms, then assigned each as belonging to either the \textgreek{οι-} or \textgreek{υ-}type.

### 4\super{th} cent.\ BCE

Of this list, 196 tokens originate in the 4\super{th} cent.\ BCE. These come primarily from Eleusis, with 102 tokens, followed by Athens with 46, then Oropos with 24, Tanagra with 15, and Megara with 10. A city-by-city examination of the distribution between \textgreek{οι-} and \textgreek{υ-}type data suggests that all target cities fell on the Athenian side of the \textgreek{οι/υ} isogloss line except for Tanagra, where speakers monophthongized \textgreek{οι} to \textgreek{υ} while their neighbors retained the original diphthong.

```{r Load_4th_cen_oi_data}
Data.oi.4 <- Data.oi[Data.oi$analysis_cen == 400,] %>% #oi for 4th cen
  droplevels()
```

```{r Visualize_4th_cen_tokens_by_city}
#| label: fig_4th_cen_oi_tokens
#| fig-cap: "Fourth Century BCE Token Counts by City"

# Visualize location counts
Data.oi.4 %>%
  ggplot(aes(x = forcats::fct_infreq(location), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Location", y = "Token Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Athens

First, the 46 Athenian tokens point to consistent retention of the diphthong \textgreek{οι}, in both root syllables and o-stem endings. The 2 instances of the genitive singular \textgreek{οἰκίας} and the 1 compound genitive plural adjective \textgreek{μετοικικῶν} 'expatriate' present the diphthong, demonstrating the retention in root syllables. Furthermore, the list shows consistent use of the diphthong in o-stem endings. The 32 instances of the dative plural article \textgreek{τοῖς} and the 1 dative/genitive dual \textgreek{τοῖν}, alongside the 7 dative plural pronouns \textgreek{αὐτοῖς} and the 3 nominatives \textgreek{αὐτοί} show retention of the \textgreek{-οι-} element in various o-stem endings. As such, the Athenian inscriptions point to a categorical conservation of the diphthong \textgreek{οι}, establishing the baseline for comparing dialect forms across cities.

```{r 4th_cen_oi_athens}
#| label: fig_4th_oi_athens
#| fig-cap: "Fourth Century BCE Athenian Token Counts"

# Visualize tokens in Athens
Data.oi.4[Data.oi.4$location == "Athens",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Eleusis

Next, unanimous retention in the 102 Eleusinean tokens suggest a general conservation of the diphthong \textgreek{οι} throughout the city. These tokens include the 7 genitive singulars \textgreek{οἰκίας} and 3 accusative singulars \textgreek{οἰκίαν}, besides 1 each of the compound forms \textgreek{ἐνοίκιον} 'allowance', \textgreek{συνοικίας} 'settlement', and \textgreek{συνοικία}. These tokens retain the root diphthong following the Athenian inscriptions. In addition, the list includes 54 occurrences of the dative plural \textgreek{τοῖς}, 33 of the dative/genitive dual \textgreek{τοῖν}, and 1 nominative plural \textgreek{αὐτοί}, demonstrating the retention in o-stem endings.

Curiously, the scraper captured the dative singular \textgreek{δήμοι}, with an incongruous short vowel \textgreek{-οι}, from inscription IG II^2^ 1,186 (PH# 3,401). Yet, the inscription also contains several other vocalic misspellings, casting the diphthong's quality into doubt. Alongside the form \textgreek{δήμοι} are the dative singulars \textgreek{τεῖ Κόρει} 'for Kore' and \textgreek{τῶι Διονυσίωι} 'for Dionysius', as well as the genitive singulars \textgreek{εὐσεβίας τῆς} 'of his piety' and \textgreek{τοῦ κοινõ} 'of the common', among others. The author's frequent alternation suggests that they conflated high-back and mid vowels on an orthographic level. Following this precedent, the token \textgreek{δήμοι} has been interpreted as \textgreek{δήμωι} and therefore removed from the list. With this extraneous dative removed, the Eleusinean tokens include only \textgreek{οι-}type data, matching the Athenian inscriptions perfectly and indicating that Eleusis fell on the Athenian side of the \textgreek{οι/υ} isogloss.

```{r 4th_cen_oi_eleusis}
#| label: fig_4th_oi_eleusis
#| fig-cap: "Fourth Century BCE Eleusinean Token Counts"

# Visualize tokens in Eleusis
Data.oi.4[Data.oi.4$location == "Eleusis",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Megara

The 10 Megarian tokens also point to the conservation of the \textgreek{οι} diphthong. This list contains 3 instances of the genitive singular \textgreek{οἰκίας}, with intact root diphthongs, as well as 5 occurrences of \textgreek{τοῖς}, 1 of \textgreek{αὐτοῖς}, and even 1 of \textgreek{τοί} in IG VII 1 (PH# 143,477). However, while \textgreek{τοί} stands out at a glance, context makes it clear that the article is a nominative plural variation which corresponds to the Attic \textgreek{οἱ}. It appears in the phrase \textgreek{ἐπειὴ τοὶ Αἰγοσθενῖτα\ladd{~} ἀνάγγελλον Ζωΐλογ Κελαίνου Βοιώτιον...} 'inasmuch as the Aigosthenians proclaimed that the Boiotian Zoilon, son of Kelainos,...' where the verb \textgreek{ἀνάγγελλον} requires either a first-person singular or third-person plural subject. As the inscription contains no first-person narrative, the verb can only belong to the third person, informing the reading of \textgreek{τοὶ Αἰγοσθενῖτα\ladd{ι}} as a nominative plural. Therefore, the \textgreek{οι} in \textgreek{τοί} has been interpreted as genuine, and the token remained in the list. As a result, these ten tokens all show a conservation of the diphthong \textgreek{οι} and thereby suggest that Megara also belonged on the Athenian side of the \textgreek{οι/υ} isogloss line.

```{r 4th_cen_oi_megara}
#| label: fig_4th_oi_megara
#| fig-cap: "Fourth Century BCE Megarian Token Counts"

# Visualize tokens in Megara
Data.oi.4[Data.oi.4$location == "Megara",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Oropos

Furthermore, the 24 Oropian inscriptions demonstrate the same conservation. This list gained considerable length owing to the prevalence of dative singulars in \textgreek{-οι}, which result from the shortening of an earlier \textgreek{-ωι}.[@dosuna2015a, 469] Representative of this change are the 11 instances of the singular dative definite article \textgreek{τοῖ} in IG VII 235 (PH# 143,712), the genuineness of which derives from its consistency of use and the retention of \textgreek{ω} in other contexts, as well as the nature of the author's infrequent mistakes regarding the vowel \textgreek{ο}. First, throughout the inscription, 9 of the 11 articles follow the preposition \textgreek{ἐν}, which requires that they represent the dative. Additionally, 8 of the 11 precede a dative noun with the same ending, as seen in the phrases \textgreek{ἐν τοῖ ἱεροῖ} 'in the temple,' \textgreek{ἐν τοῖ κομητηρίοι} 'in the cemetery,' and \textgreek{τοῖ βολομένοι} 'for one willing.' This consistency with which the author used the short \textgreek{-οι} suggests that the author knowingly used this spelling to indicate the \textgreek{o-}stem dative singular ending.

Next, persistent spellings with the expected \textgreek{ω} in other contexts suggest that the author did distinguish between it and the short vowel \textgreek{ο} on an orthographic level. For example, the author retained \textgreek{ω}'s in all nine instances of the genitive plural article \textgreek{τῶν}, with no occurrences of a misspelled \iform[G]{το̃ν}. Additionally, clauses that require a genitive plural show consistent use of the plural marker \textgreek{-ων}, as in \textgreek{μέχρι τριῶν δραχμέων}'(a penalty of) up to three drachmas,' \textgreek{περὶ τῶν {\dots} ἀδικιῶν} 'concerning the wrongdoings,' and \textgreek{κατεύχεσθαι δὲ τῶν ἱερῶν} 'praying over the temples.' The regularity of the author's spelling, with no conflation of \textgreek{ω} and \textgreek{ο}, indicates their consistent distinction between the two graphemes. As such, the likelihood that the ending \textgreek{-οι} represents a constant misspelling of \textgreek{-ωι} remains low.

Moreover, mistaking the letter \textgreek{ο} for \textgreek{ω} would not fit with the orthographic character of the extant spelling variations in the inscription. The text contains three instances of an incorrect \textgreek{ο}. The first two appear in the genitive singulars \textgreek{ἑκάστο} 'of each' and \textgreek{το̃ ἱερέος} 'of the temple,' in contrast with the correct spellings in \textgreek{τοῦ ἱεροῦ} and \textgreek{ἑκάστου} later in the text. The third appears in the adverb \textgreek{ἐντο̃θα} 'there,' and while the inscription does not contain any instances of \textgreek{\*ἐνταῦθα}, the \textgreek{αυ} diphthong does appear elsewhere in similar contexts, as in \textgreek{αὐθημερόν} 'on the same day,' \textgreek{θησαυρόν} 'treasure,' and even alongside the genitive singular ending in \textgreek{αὐτοῦ}. In each instance, the error involves substituting a single \textgreek{ο} for a digraph ending in an \textgreek{υ}, further lowering the likelihood of the ending \textgreek{-οι} representing a universal misspelling of \textgreek{-ωι}.

Overall, given the author's consistent use of the dative singular \textgreek{-οι} in place of \textgreek{-ωι} with no evidence to the contrary, as well as no basis for suspecting that the author would mistakenly write \textgreek{ο} for \textgreek{ω}, the 11 instances of \textgreek{τοῖ} have been retained in the data set. On the same grounds, one instance of \textgreek{ἑαυτοῖ} has also remained. Besides these, the Oropian data contains 12 more usable tokens. These include 8 instances of the dative plural article \textgreek{τοῖς}, 2 of the genitive plural \textgreek{οἰκιῶν}, 1 genitive singular \textgreek{οἰκίης}, and 1 dative plural \textgreek{αὐτοῖς}. That the set contains no \textgreek{υ}-type tokens suggests that Oropos fell on the Athenian side of the \textgreek{οι/υ} isogloss line.

```{r 4th_cen_oi_oropos}
#| label: fig_4th_oi_oropos
#| fig-cap: "Fourth Century BCE Oropian Token Counts"

# Visualize tokens in Oropos
Data.oi.4[Data.oi.4$location == "Oropos",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Tanagra

```{r Load_4th_cen_tanagra_oi_data}
# Filter for Tanagran Data
Data.oi.4.Tanagra <- Data.oi.4 %>%
  filter(str_detect(location, "(Athens|Tanagra)") == T) %>%
  droplevels()
```

However, the 15 tokens collected from Tanagra indicate that the city belonged on the \textgreek{υ} side of the \textgreek{οι}/\textgreek{υ} isogloss line. Of the data collected, 12 tokens contain the monophthong \textgreek{υ} in place of the diphthong \textgreek{οι}. The definite article occurs 4 times in the dative, with 3 instances of the plural \textgreek{τῦς} and 1 of the singular \textgreek{τῦ}. The list further includes 3 of the dative plural pronoun \textgreek{αὐτῦς}, 2 of the genitive singular \textgreek{ϝυκίας}, and 1 each of the genitive singular \textgreek{ὐκίας}, the dative singular \textgreek{δάμυ}, and the dative singular \textgreek{αὐτῦ}.

Alongside these forms, the data contains 3 tokens that retain the diphthong \textgreek{οι}. 2 are the dative singular article \textgreek{τοῖ}, and 1 is the noun \textgreek{δάμοι}. However, the distribution of data types per city suggests a relationship between the origin of an inscription and the data type therein, with 93.87% of \textgreek{οι}-type data originating from Athens and 100% of \textgreek{υ}-type data originating from Tanagra.

```{r 4th_cen_oi_tanagra}
#| label: fig_4th_oi_tanagra
#| fig-cap: "Fourth Century BCE Tanagran Token Counts"

# Visualize tokens in Tanagra
Data.oi.4[Data.oi.4$location == "Tanagra",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

To determine the presence of any relationship between a token's origin and its data type, the author performed Fisher's exact test with the following hypotheses:

H0

:   There is no relationship between the variables `location` and `data_type` in the combined Athenian and Tanagran data of the 4\super{th} cent.\ BCE.

HA

:   There is a relationship between the variables `location` and `data_type` in the combined Athenian and Tanagran data of the 4\super{th} cent.\ BCE.

The test results in a *p*-value of 2.612 x 10^-10^, indicating a vanishingly slim chance that, based on the collected tokens, the distribution of variables by type between Athens and Tanagra arose from random chance. Therefore, the author rejects the null hypothesis and asserts that the occurrence of \textgreek{υ} instead of \textgreek{οι} is connected to the origin of an inscription within the data set. Tanagra, then, belonged opposite Athens on the \textgreek{υ} side of the \textgreek{οι}/\textgreek{υ} isogloss line.

```{r 4th_cen_oi_tanagra_fisher}
#| include: false

XT.oi.4.Tanagra <-
  stats::xtabs( ~ data_type + location, data = Data.oi.4.Tanagra)
# Fisher's Exact Test for Tanagran Data
fisher.test(XT.oi.4.Tanagra)
```

Furthermore, given that the \textgreek{υ-}type data are found only in Tanagran inscriptions, the \textgreek{οι}/\textgreek{υ} isogloss line extended between the city and its neighbors. Whereas Athenians, Eleusineans, Megarians, and Oropians retained the \textgreek{οι} diphthong into the 4\super{th} cent.\ BCE, the majority of Tanagrans adopted the innovative monophthong \textgreek{υ}.

### 3\super{rd} cent.\ BCE
```{r Load_3rd_cen_oi_data}
Data.oi.3 <- Data.oi[Data.oi$analysis_cen == 300,] %>% #oi for 3rd cen
  droplevels()
```

```{r count_3_oi}
Count.oi.3 <- Data.oi.3 %>% nrow()
Count.oi.3.Athens <- Data.oi.3 %>%
  filter(str_detect(location, "Athens") == T) %>% nrow()
Count.oi.3.Eleusis <- Data.oi.3 %>%
  filter(str_detect(location, "Eleusis") == T) %>% nrow()
Count.oi.3.Oropos <- Data.oi.3 %>%
  filter(str_detect(location, "Oropos") == T) %>% nrow()
Count.oi.3.Megara <- Data.oi.3 %>%
  filter(str_detect(location, "Megara") == T) %>% nrow()
Count.oi.3.Tanagra <- Data.oi.3 %>%
  filter(str_detect(location, "Tanagra") == T) %>% nrow()
Count.oi.3.Pagai <- Data.oi.3 %>%
  filter(str_detect(location, "Pagai") == T) %>% nrow()
Count.oi.3.Aigosthena <- Data.oi.3 %>%
  filter(str_detect(location, "Aigosthena") == T) %>% nrow()
```

Of the data set collected for the \textgreek{οι/υ} isoglosses, `r Count.oi.3` tokens originated from the 3\super{rd} cent.\ BCE. This set includes evidence for all 7 cities, with `r Count.oi.3.Oropos` tokens found at Oropos, `r Count.oi.3.Eleusis` at Eleusis, `r Count.oi.3.Tanagra` at Tanagra, `r Count.oi.3.Aigosthena` at Aigosthena, `r Count.oi.3.Athens` from Athens, `r Count.oi.3.Megara` from Megara, and `r Count.oi.3.Pagai` from Pagai.

```{r Visualize_3rd_cen_tokens_by_city, fig.pos='p'}
#| label: fig_3rd_cen_oi_tokens
#| fig-cap: "Third Century BCE Token Counts by City"

# Visualize location counts
Data.oi.3 %>%
  ggplot(aes(x = forcats::fct_infreq(location), fill = data_type)) +
  geom_bar() +
  geom_text(data = Data.oi.3[Data.oi.3$location != "Tanagra",], stat = "count", aes(label = after_stat(count))) +
  geom_text_repel(data = Data.oi.3[Data.oi.3$location == "Tanagra",], stat = "count", aes(label = after_stat(count)), direction = 'y', ylim = c(-1,40)) +
  labs(x = "Location", y = "Token Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

```{r 3rd_cen_oi_athens, fig.pos='p'}
#| label: fig_3rd_oi_athens
#| fig-cap: "Third Century BCE Athenian Token Counts"

# Visualize tokens in Athens
Data.oi.3[Data.oi.3$location == "Athens",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Athens

Athens in the 3\super{rd} cent.\ BCE is represented by only `r Count.oi.3.Athens` tokens, partly due to the fragmentary nature of the inscriptions and the lack of any changes to create an innovation suitable for analysis. To start, a search of the inscriptions for pairs of brackets \textgreek{\ladd{\ }} with `stringr::str_count()` shows 507 instances of text-initial fragmentation. Furthermore, similar searches for the single brackets \textgreek{\lbrk} and \textgreek{\rbrk} return 6 gaps at the end of a line and 1 at the beginning. The inscriptions also contain 101 long sections of missing text indicated by sequential dashes \--. This fragmentation created large quantities of potentially unusable tokens, including at least 155 of only a single character in length from 3\super{rd} cent.\ Athens.

Additionally, Attic Greek lacked any changes comparable to the Boiotian substitution of the short \textgreek{-οι} for the dative singular ending \textgreek{-ωι}, and the inscriptions thereby missed out on the increased token count seen in Oropos in the 4\super{th} cent.\ BCE. As a result, the Athenian data must rely on 6 tokens: 4 instances of the dative plural \textgreek{τοῖς} and 2 of \textgreek{αὐτοῖς}. These tokens characterize Athens as having retained the diphthong οι into the 3\super{rd} cent.\ and establish the city as the point of comparison for isogloss tests.

#### Eleusis

Next, the `r Count.oi.3.Eleusis` Eleusinean tokens show that the city belonged on the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss line. 48 of these are occurrences of the dative plural article \textgreek{τοῖς}, 2 are of the dative/genitive dual \textgreek{τοῖν}, and 3 of the dative plural pronoun \textgreek{αὐτοῖς}. IG II^2^ 1,218 (PH# 3,433) also provides one instance of the fragment \textgreek{αὐτοι(-)}. The word appears at the end of a line, raising the possibility that it continued at the start of the next. However, the entire left half of the inscription is missing, removing any direct evidence for the fragment's exact form. Still, particulars of compound formation and the shape of available o-stem endings point to 3 plausible options. First, the \textgreek{αὐτοι(-)} likely did not begin a compound word: the combination \textgreek{αὐτ-}C would have prompted the insertion of the connecting vowel \textgreek{-ο-}, and the combination \textgreek{αὐτ-}V could have introduced an \textgreek{-ι-}, but neither instance would produce the segment \textgreek{-οι-}.

However, the diphthong could appear in three declined forms. The nominative plural \textgreek{αὐτοί}, the dative/genitive dual \textgreek{αὐτοῖν}, and the dative plural \textgreek{αὐτοῖς} could all introduce the \textgreek{-οι-} segment in \textgreek{αὐτοι(-)}. Furthermore, though the exact context is lost, the fragment is directly preceded by the dative reflexive pronoun \textgreek{σφίσιν}. This phrasing raises the likelihood that the fragment represents the dative plural \textgreek{αὐτοῖ\ladd{ς}}, implying that the \textgreek{-οι(-)} should be interpreted as genuine. Given this, as well as the fact that the extant text does show the diphthong in its entirety, the token \textgreek{αὐτοι(-)} has been retained in the data set. Therefore, the Eleusinean data shows uniform retention of the diphthong \textgreek{οι}, showing that the city belonged on the Athenian side of the \textgreek{οι/υ} isogloss line during the 3\super{rd} cent.\ BCE.

```{r 3rd_cen_oi_eleusis}
#| label: fig_3rd_oi_eleusis
#| fig-cap: "Third Century BCE Eleusinean Token Counts"

# Visualize tokens in Eleusis
Data.oi.3[Data.oi.3$location == "Eleusis",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Megara

The Megarian data comprise `r Count.oi.3.Megara` tokens that unanimously suggest the Megarians retained the \textgreek{οι} diphthong. The list includes 4 occurrences of the dative plural article \textgreek{τοῖς}, 1 of the pronoun \textgreek{αὐτοῖς}, and 1 of the genitive singular noun \textgreek{οἰκίας}. As each token contains the diphthong \textgreek{οι}, and none the monophthong \textgreek{υ}, the data suggest that Megara was situated on the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss line and that the speakers there retained the original diphthong through the 3\super{rd} cent.\ BCE.

```{r 3rd_cen_oi_megara, fig.pos='p'}
#| label: fig_3rd_oi_megara
#| fig-cap: "Third Century BCE Megarian Token Counts"

# Visualize tokens in Megara
Data.oi.3[Data.oi.3$location == "Megara",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

```{r 3rd_cen_oi_pagai, fig.pos='p'}
#| label: fig_3rd_oi_pagai
#| fig-cap: "Third Century BCE Pagaian Token Counts"

# Visualize tokens in Pagai
Data.oi.3[Data.oi.3$location == "Pagai",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Pagai

Next, the `r Count.oi.3.Pagai` tokns from Pagai suggest that the city retained the \textgreek{οι} diphthong. These include 4 instances of the dative plural \textgreek{τοῖς} and 1 of \textgreek{αὐτοῖς}. This lack of monophthongized \textgreek{υ}-type tokens indicates that the city was also situated on the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss line.

#### Aigosthena

The `r Count.oi.3.Aigosthena` Aigosthenian tokens also suggest that the population retained the diphthong \textgreek{οι}. The data includes 5 instances of the nominative plural \textgreek{τοί} and 2 each of the dative plurals \textgreek{αὐτοῖς} and \textgreek{τοῖς}. Besides these, there are 6 dative singulars with the short ending -\textgreek{οι}. IG VII 207 (PH# 143,684) shows 2 occurrences of \textgreek{τοῖ}, 1 of \textgreek{δάμοι}, and 1 of \textgreek{αὑτοῖ}, whereas IG VII 208 (PH# 143,685) includes 1 occurrence each of \textgreek{τοῖ} and \textgreek{αὑτοῖ}. Overall, each of the 11 tokens shows the retention of the diphthong \textgreek{οι}, indicating that Aigosthena belonged on the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss line during the 3\super{rd} cent.\ BCE.

```{r 3rd_cen_oi_aigosthena}
#| label: fig_3rd_oi_aigosthena
#| fig-cap: "Third Century BCE Aigosthenian Token Counts"

# Visualize tokens in Aigosthena
Data.oi.3[Data.oi.3$location == "Aigosthena",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Oropos

```{r Load_3rd_cen_oropian_oi_data}
# Filter for Oropian data
Data.oi.3.Oropos <- Data.oi.3 %>%
  filter(str_detect(location, "(Athens|Oropos)") == T) %>%
  droplevels()
```

Similarly, the `r Count.oi.3.Oropos` Oropian tokens show the city's continued placement on the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss line. However, whereas the 4\super{th} cent.\ data previously showed uniform retention of the diphthong, the 3\super{rd} cent.\ data contain occasional instances of \textgreek{υ}-type data alongside the more popular \textgreek{οι}-type. Nevertheless, the data does not sufficiently indicate that the population of Oropos adopted the innovative monophthong.

The \textgreek{οι}-type tokens comprise the vast majority of the evidence. This includes 169 instances of the dative plural \textgreek{τοῖς}, 108 of the genitive singular \textgreek{οἰκίας}, and 85 of the dative plural \textgreek{αὐτοῖς}. Alongside these are 8 occurrences each of the dative singulars \textgreek{τοῖ} and \textgreek{αὐτοῖ}, as well as 4 of \textgreek{δάμοι}, 2 of the genitive singular \textgreek{ϝοικίας}, and 1 nominative singular \textgreek{οἰκία}.

Contrary to these, the data also contains 3 instances of the dative singulars \textgreek{τῦ} and \textgreek{δάμυ}, as well as 1 each of the genitive singulars \textgreek{ϝυκίας}, \textgreek{ὐκίας}, and \textgreek{τῦς}. When comparing Oropos and Athens, the \textgreek{υ}-type data originate only from the former, while the \textgreek{οι}-type data appear in inscriptions from both. This distribution raises the possibility of a relationship between the location of an inscription and the data type contained within it.

```{r 3rd_cen_oi_oropos}
#| label: fig_3rd_oi_oropos
#| fig-cap: "Third Century BCE Oropian Token Counts"

# Visualize tokens in Aigosthena
Data.oi.3[Data.oi.3$location == "Oropos",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

To test for the presence of such a relationship between a token's origin and its data type, the author performed Fisher's exact test with the following hypotheses:

H0

:   There is no relationship between the variables `location` and `data_type` in the combined Athenian and Oropian data of the 3\super{rd} cent.\ BCE.

HA

:   There is a relationship between the variables `location` and `data_type` in the combined Athenian and Oropian data of the 3\super{rd} cent.\ BCE.

The test resulted in a *p*-value of 1, indicating a 100% chance that, when observing only the data collected for Athens and Oropos in the 3\super{rd} cent., the distribution arose by random chance. Therefore, the author fails to reject the null hypothesis and cannot assert that the occurrences of \textgreek{υ} in place of \textgreek{οι} are due to an inscription's origins in Oropos. Accordingly, Oropos belonged on the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss line, which indicates that the great majority of Oropians preferred forms with the inherited diphthong \textgreek{οι} over those with the innovative monophthong \textgreek{υ}.

```{r 3rd_cen_oi_oropos_fisher}
#| include: false

XT.oi.3.Oropos <-
  stats::xtabs( ~ data_type + location, data = Data.oi.3.Oropos)
# Fisher's Exact Test for Tanagran Data
fisher.test(XT.oi.3.Oropos)
```

#### Tanagra

```{r Load_3rd_cen_tanagran_oi_data}
# Filter for Tanagran data
Data.oi.3.Tanagra <- Data.oi.3 %>%
  filter(str_detect(location, "(Athens|Tanagra)") == T) %>%
  droplevels()
```

Last, and in a departure from the precedent of the previous century, `r Count.oi.3.Tanagra` the Tanagran tokens from the 3\super{rd} cent.\ BCE suggest that the local population also preferred forms with the diphthong \textgreek{οι} over those with \textgreek{υ}. The set contains 18 tokens with the diphthong: 4 each of the dative plural article \textgreek{τοῖς} and the singular \textgreek{δάμοι}, as well as 3 of the article \textgreek{τοῖ} and the pronoun \textgreek{αὐτοῖς}. Also among the \textgreek{οι}-type data are 2 instances of the genitive singular \textgreek{οἰκίας}, 1 of \textgreek{ϝοικίας}, and 1 of the dative singular \textgreek{αὐτοῖ}.

Concurrent with these are 9 \textgreek{υ}-type tokens. These include 2 instances of the genitive singular \textgreek{ϝυκίας} and the dative plural \textgreek{αὐτῦς}, as well as 2 each of the dative singulars \textgreek{τῦ} and \textgreek{δάμυ}, found each time as a pair in the phrase \textgreek{δεδόχθη} \textgreek{τῦ} \textgreek{δάμυ} 'be it resolved by the deme.' Finally, the data includes 1 dative plural \textgreek{τῦς}.

```{r 3rd_cen_oi_tanagra}
#| label: fig_3rd_oi_tanagra
#| fig-cap: "Third Century BCE Tanagran Token Counts"

# Visualize tokens in Tanagra
Data.oi.3[Data.oi.3$location == "Tanagra",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

As seen upon comparing the distribution of data types across the Attic and Tanagran data sets, most inscriptions originate from Tanagra, and a full third of the Tanagran tokens are of the \textgreek{υ}-type. Therefore, the author performed Fisher's exact test with the following hypotheses to test whether the distribution indicates a relationship between between a token's origin and its data type.

H0

:   There is no relationship between the variables `location` and `data_type` in the combined Athenian and Tanagran data of the 3rd cent.\ BCE.

HA

:   There is a relationship between the variables `location` and `data_type` in the combined Athenian and Tanagran data of the 3rd cent.\ BCE.

Surprisingly, the test returned a *p*-value of 0.1557, which indicates a 15.57% chance that the appearance of \textgreek{υ}-type data is not due to an inscription's origins in Tanagra, according to the tokens gathered for the 3rd cent.\ BCE. While these results represent a departure from the precedent set in the 4\super{th} cent., and though the *p*-value only surpasses the alpha value by little more than .10, the results nevertheless do not meet the 0.05 critical threshold. Therefore, the author fails to reject the null hypothesis and cannot assert that the extant \textgreek{υ}-type tokens are representative of the broader city dialect. These results suggest that Tanagra may have belonged on the \textgreek{οι} side of the \textgreek{οι}/\textgreek{υ} isogloss line during the 3rd cent.\ BCE. However, given the conclusions in previous literature and the results of the 2\super{nd} cent.\ BCE tests below, this outcome appears highly unlikely. This matter is discussed more thoroughly in the isogloss interpretations.

```{r 3rd_cen_oi_tanagra_fisher}
#| include: false

XT.oi.3.Tanagra <-
  stats::xtabs( ~ data_type + location, data = Data.oi.3.Tanagra)
# Fisher's Exact Test for Tanagran Data
fisher.test(XT.oi.3.Tanagra)
```

### 2\super{nd} cent.\ BCE

```{r Load_2nd_cen_oi_data}
Data.oi.2 <- Data.oi[Data.oi$analysis_cen == 200,] %>% #oi for 2nd cen
  droplevels()
```

```{r count_2_oi}
Count.oi.2 <- Data.oi.2 %>% nrow()
Count.oi.2.Athens <- Data.oi.2 %>%
  filter(str_detect(location, "Athens") == T) %>% nrow()
Count.oi.2.Eleusis <- Data.oi.2 %>%
  filter(str_detect(location, "Eleusis") == T) %>% nrow()
Count.oi.2.Oropos <- Data.oi.2 %>%
  filter(str_detect(location, "Oropos") == T) %>% nrow()
Count.oi.2.Megara <- Data.oi.2 %>%
  filter(str_detect(location, "Megara") == T) %>% nrow()
Count.oi.2.Tanagra <- Data.oi.2 %>%
  filter(str_detect(location, "Tanagra") == T) %>% nrow()
Count.oi.2.Pagai <- Data.oi.2 %>%
  filter(str_detect(location, "Pagai") == T) %>% nrow()
Count.oi.2.Aigosthena <- Data.oi.2 %>%
  filter(str_detect(location, "Aigosthena") == T) %>% nrow()
```

```{r Visualize_2nd_cen_tokens_by_city}
#| label: fig_2nd_cen_oi_tokens
#| fig-cap: "Second Century BCE Token Counts by City"

# Visualize location counts
Data.oi.2 %>%
  ggplot(aes(x = forcats::fct_infreq(location), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Location", y = "Token Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

`r Count.oi.2` tokens across 5 cities evidence the \textgreek{οι}/\textgreek{υ} isogloss line of the 2\super{nd} cent.\ BCE. `r Count.oi.2.Eleusis` tokens originate from Eleusis, `r Count.oi.2.Oropos` from Oropos, `r Count.oi.2.Athens` from Athens, `r Count.oi.2.Megara` from Megara, `r Count.oi.2.Aigosthena` from Aigosthena, and `r Count.oi.2.Tanagra` Tanagra. Note that while most cities retained the diphthong \textgreek{οι}, the data once again indicates that Tanagra accepted the monophthongization during the 2\super{nd} cent.\ BCE.

#### Athens

The Athenian inscriptions are represented by `r Count.oi.2.Athens` tokens, the makeup of which reflects those of the 3rd cent.\ The data contain all \textgreek{οι}-type tokens, with 5 instances of the dative plural \textgreek{τοῖς} and 2 of \textgreek{αὐτοῖς}. With no extant \textgreek{υ}-type tokens, the data characterizes Athens as having retained the \textgreek{οι} diphthong into the 2\super{nd} cent.\ BCE and establishes the city as the main point of comparison for isogloss tests.

```{r 2nd_cen_oi_athens}
#| label: fig_2nd_oi_athens
#| fig-cap: "Second Century BCE Athenian Token Counts"

# Visualize tokens in Athens
Data.oi.2[Data.oi.2$location == "Athens",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Eleusis

The Eleusinean data contain `r Count.oi.2.Eleusis` tokens that indicate the city accorded with Athens and preserved the diphthong \textgreek{οι}. The data exclusively contain occurrences of the plural article \textgreek{τοῖς}. As the city provides no contrary \textgreek{υ}-type tokens, the data suggest that Eleusineans retained the \textgreek{οι} diphthong through the 2\super{nd} cent.\ BCE.

```{r 2nd_cen_oi_eleusis}
#| label: fig_2nd_oi_eleusis
#| fig-cap: "Second Century BCE Eleusinean Token Counts"

# Visualize tokens in Eleusis
Data.oi.2[Data.oi.2$location == "Eleusis",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Megara

Similarly, the `r Count.oi.2.Megara` tokens from Megara indicate that the city's population continued to preserve the diphthong through the 2\super{nd} cent.\ The data contain 3 instances of the dative plural \textgreek{τοῖς}, 2 of \textgreek{αὐτοῖς}, and 1 of the nominative plural \textgreek{τοί}. The scraper also captured 1 instance of the fragment \textgreek{τοι\ladd{\ }}, which fell in with \textgreek{τοί} during the data selection. However, the author has elected to retain the fragment.

The instance of \textgreek{τοι\ladd{\ }} appears at the end of line 24 in IG VII 21 (PH# 143,497). However, the beginning of the following line is fully legible, reading \textgreek{ἄλλοις} \textgreek{προξένοις} \textgreek{καὶ} \textgreek{εὐεργέταις} 'other public friends and benefactors,' raising the possibility that \textgreek{τοι\ladd{~}} substantivizes the following \textgreek{ἄλλοις} \textgreek{προξένοις}, a likelihood improved by the lack of other dative plurals in the same or any adjacent clauses. Furthermore, the immediate context lacks any basis for the dative/genitive dual \textgreek{τοῖ\ladd{ν}}, the nominative plural \textgreek{τοί \ladd{$\emptyset$}}, or even the dative singular \textgreek{τοῖ \ladd{$\emptyset$}} as the inscription otherwise contains the long dative ending -\textgreek{ωι}, seen in \textgreek{δάμωι} and \textgreek{χρυσέωι} \textgreek{στεφάνωι} 'with a golden wreath.' As such, \textgreek{τοῖ\ladd{ς}} remains the only likely reading. Given this, and, crucially, the fact that the fragment depicts the diphthong \textgreek{οι} in its entirety, the author has maintained \textgreek{τοι\ladd{~}} in the data.

Overall, the `r Count.oi.2.Megara` tokens from Megara all belong to the \textgreek{οι}-type. Without any \textgreek{υ}-type tokens to test against, the data suggest that Megara belonged on the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss during the 2\super{nd} cent.\ BCE.

```{r 2nd_cen_oi_megara}
#| label: fig_2nd_oi_megara
#| fig-cap: "Second Century BCE Megarian Token Counts"

# Visualize tokens in Megara
Data.oi.2[Data.oi.2$location == "Megara",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Aigosthena

The `r Count.oi.2.Aigosthena` Aigosthenian inscriptions suggest that the local speakers retained the \textgreek{οι} diphthong. This data contains 2 certain occurrences of the dative plural \textgreek{τοῖς}, as well as 1 fragment \textgreek{οἰκία\ladd{~}}.

The fragment appears in IG VII 223 (PH# 143,700), the right edge of which has suffered significant damage, at the end of line 15. However, fully extant before this is the rest of an honorific formula: \textgreek{ἔγχτησιν} \textgreek{γᾶς} \textgreek{καὶ} (\textgreek{οἰκία\ladd{~}}) 'the right to purchase land and (a house).'[@mclean2011, 235] This context leaves little doubt over the reading \textgreek{οἰκία\ladd{ς}}. Given this, and since the fragment clearly shows the diphthong \textgreek{οι} in its entirety, the instance of \textgreek{οἰκία\ladd{~}} has remained in the set.

With the fragment accounted for, the Aigosthenian tokens all belong to the \textgreek{οι}-type. Therefore, the data indicate that the city belonged to the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss line during the 2\super{nd} cent.\ BCE.

```{r 2nd_cen_oi_aigosthena}
#| label: fig_2nd_oi_aigosthena
#| fig-cap: "Second Century BCE Aigosthenian Token Counts"

# Visualize tokens in Aigosthena
Data.oi.2[Data.oi.2$location == "Aigosthena",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Oropos

The `r Count.oi.2.Oropos` Oropian tokens indicate retention of the diphthong \textgreek{οι}. The set exclusively contains \textgreek{οι}-type tokens, with 9 instances of the dative plural \textgreek{τοῖς}, 5 of \textgreek{αὐτοῖς}, and 1 occurrence each of the genitive singular \textgreek{οἰκίας} and the nominative plural \textgreek{τοί}. With no contrary \textgreek{υ}-type tokens, the data suggest that Oropos belonged on the Athenian side of the \textgreek{οι}/\textgreek{υ} isogloss during the 2\super{nd} cent.\ BCE.

```{r 2nd_cen_oi_oropos}
#| label: fig_2nd_oi_oropos
#| fig-cap: "Second Century BCE Oropian Token Counts"

# Visualize tokens in Aigosthena
Data.oi.2[Data.oi.2$location == "Oropos",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

#### Tanagra

```{r Load_2nd_cen_tanagran_oi_data}
# Filter for Tanagran data
Data.oi.2.Tanagra <- Data.oi.2 %>%
  filter(str_detect(location, "(Athens|Tanagra)") == T) %>%
  droplevels()
```

Contrary to all the neighboring cities and the precedent set by the 3rd cent.\ test results, the `r Count.oi.2.Tanagra` Tanagran data suggest that the city generally accepted the monophthongization \textgreek{οι}\>\textgreek{υ} during the 2\super{nd} cent.\ BCE. This data contains 3 instances of \textgreek{τύ} as a nominative plural article, each in phrases indicating the performants of certain burial rites.

```{=tex}
\begin{table}[htbp]
\centering
\caption{Second Century BCE Instances of \textgreek{υ}-Type Data in Tanagra}
\label{tab:2nd_oi_tanagra_utype}
\begin{tabular}{@{}lllll@{}}
\toprule
IG & PH & Tanagran & Attic & English \\ \midrule
IG VII 685 & PH\# 144,164 & \textgreek{τὺ Ἀθαναϊστή}     & \textgreek{οἱ Ἀθαναισταί}   & The Devotees of Athena   \\
IG VII 686 & PH\# 144,165 & \textgreek{τὺ Διωνυσιαστή}   & \textgreek{οἱ Διωνυσιασταί} & The Devotees of Dionysus \\
IG VII 687 & PH\# 144,166 & \textgreek{τὺ Ἀθαναϊστ\d{ή}} & \textgreek{οἱ Ἀθαναισταί}   & The Devotees of Athena   \\ \bottomrule
\end{tabular}
\end{table}
```
Comparing the distribution of \textgreek{οι}- and \textgreek{υ}-type tokens between Athens and Tanagra shows that the \textgreek{υ}-types originate exclusively from the latter, raising the possibility that an inscription's place of origin relates to the data type found therein.

```{r 2nd_cen_oi_tanagra}
#| label: fig_2nd_oi_tanagra
#| fig-cap: "Second Century BCE Tanagran Token Counts"

# Visualize tokens in Aigosthena
Data.oi.2[Data.oi.2$location == "Tanagra",] %>%
  ggplot(aes(x = forcats::fct_infreq(token), fill = data_type)) +
  geom_bar() +
  geom_text(stat = "count", aes(label = after_stat(count))) +
  labs(x = "Token", y = "Count") +
  theme_classic() +
  scale_x_discrete(guide = guide_axis(angle = 45)) +
  scale_fill_manual(values=iso_colors)
```

To test for the presence of a relationship between a token's origin and its data type, the author performed Fisher's exact test with the following hypotheses:

H0

:   There is no relationship between the variables `location` and `data_type` in the combined Athenian and Tanagran data of the 2\super{nd} cent.\ BCE.

HA

:   There is a relationship between the variables `location` and `data_type` in the combined Athenian and Tanagran data of the 2\super{nd} cent.\ BCE.

The test resulted in a *p*-value of 0.008\={3}, which indicates a less-than-1% chance that the distribution of data types is due to random chance, per the tokens collected. Therefore, the author rejects the null hypothesis and asserts that the occurrences of \textgreek{υ} in place of \textgreek{οι} are due to an inscription's origins in Tanagra. As such, the city fell on the \textgreek{υ} side of the \textgreek{οι}/\textgreek{υ} isogloss line during the 2\super{nd} cent.\ BCE.

```{r 2nd_cen_oi_tanagra_fisher}
#| include: false

XT.oi.2.Tanagra <-
  stats::xtabs( ~ data_type + location, data = Data.oi.2.Tanagra)
# Fisher's Exact Test for Tanagran Data
fisher.test(XT.oi.2.Tanagra)
```

### Interpretations

All in all, the collected tokens point to a relatively stable \textgreek{οι}/\textgreek{υ} isogloss line in Central Greece within the period of interest, though the 4\super{th} cent.\ lacks any Aigosthenian or Pagaian data from which to draw a definitive isogloss line. However, the 3\super{rd} cent.\ includes Pagaian and Aigosthenian data, and the 2\super{nd} provides further tokens from Aigosthena, with both sets evidencing the isogloss line between the cities and Tanagra. In addition, the type of tokens from each city corresponds with that of the tokens from Megara in the applicable centuries, and the Megarian data indicate consistent retention of the \textgreek{οι} diphthong across the period of interest. Two possibilities arise from this.

First, Pagai and Aigosthena belonged on the \textgreek{υ} side of the isogloss line during the 4^th^ cent.\ BCE. Sometime before the 3^rd^ cent., Pagaians and Aigosthenians selected for the diphthong \textgreek{οι}. Under this hypothesis, the data from the 3^rd^ cent.\ depicts a shifting isogloss line as it spread through Megaris from the southwest to the northeast.

Second, Pagai and Aigosthena already belonged on the \textgreek{οι} side of the isogloss line during the 4^th^ cent.\ BCE. The data from the 3^rd^ and 2^nd^ cents.\ then evidence a continued retention of the diphthong.

The first possibility does not account for the Megarian data insofar as it assumes that the city was separated from Pagai and Aigosthena by the \textgreek{οι}/\textgreek{υ} isogloss line. Additionally, the first possibility requires the whole-cloth insertion of a data type not otherwise found within the relevant cities besides accompanying phonological changes.

However, in assuming that Megara was on the same side of the isogloss line, the second possibility is suggestive of the inter-city correspondence seen in later centuries. Given that Pagai and Aigosthena agreed with Megara concerning a preference for the diphthong \textgreek{οι} in the 3^rd^ cent., and Aigosthena continued to do so in the 2^nd^ cent., the second theory can lean on the later relationship between the cities of Megaris and incorporate the tokens from Megara as suggestive of a broader, regional dialect feature. Furthermore, the second theory does not require the interpolation of a second data type and so frames the Pagaian and Aigosthenian data as a continuation of local dialects.

Given that the second possibility can integrate the Megarian data with less complication and avoids extra phonological changes by interpreting later data as evidence for the continued retention of the diphthong \textgreek{οι}, it appears more likely than the complicated first possibility. Therefore, the author has placed the entirety of Megaris on the \textgreek{οι} side of the \textgreek{οι}/\textgreek{υ} isogloss line during the 4^th^ and 2^nd^ centuries. Hypothetical portions of the isogloss line have been drawn with dashed lines (cf. figs. 22-24 below), while evidenced portions have been drawn with a solid line.

The 3^rd^ cent., however, stands out as the only period with no cities firmly on the \textgreek{υ} side of the \textgreek{οι}/\textgreek{υ} isogloss line. The 18 \textgreek{οι}-type tokens from Tanagra seem to overshadow the 9 \textgreek{υ}-type tokens and suggest some loss of local dialectal features following the 4^th^ cent., while the lack of any \textgreek{οι}-type data from the 2^nd^ cent.\ would apparently indicate the reversal of that trend. Yet the quantity of 3^rd^ cent.\ \textgreek{οι}-type Tanagran tokens is itself noteworthy in the context of the broader data set. Whereas the 2^nd^ and 4^th^ cent.\ Tanagran data respectively have 0 and 3 \textgreek{οι}-type tokens, the 3^rd^ cent.\ data have 18. To determine whether this discrepancy in data-type distribution between locations and centuries is significant, the author performed 3 post hoc Fisher's exact tests. The first compares the \textgreek{οι}-type token counts from Tanagra and Athens in the 4^th^ and 2^nd^ cents.\ BCE to establish a baseline of comparison between the two most similar counts. The second compares the \textgreek{οι}-type token counts in the 2^nd^ and 3^rd^ cents., and the third compares those between the 3^rd^ and 4^th^. The tests were performed with the following hypotheses:

H0

:   There is no relationship between the variables `location` and `analysis_cen` in the combined Athenian and Tanagran data of the target centuries.

HA

:   There is a relationship between the variables `location` and `analysis_cen` in the combined Athenian and Tanagran data of the target centuries.

The first test returned a *p*-value of 1, indicating that the distribution of \textgreek{οι}-type tokens is not significantly related to the centuries of origin. However, the second test resulted in a *p*-value of 0.0006526, while the third resulted in a *p*-value of 2.333 x 10^-09^. In each instance, the *p*-value indicates that the distribution of \textgreek{οι}-type tokens likely is significant to the centuries of origin. Since both tests that suggest a significant relationship include the 3^rd^ cent.\ BCE, those relationships appear to revolve around the century's high Tanagran token count. This raises the suspicion that the \textgreek{οι}-type Tanagran data are overrepresented in the 3^rd^ cent., possibly explaining the small margin of failure, 0.10, for the original test between the Athenian and Tanagran data sets.

Given this possible overrepresentation of \textgreek{οι}-type tokens, and considering that Tanagra in the 4^th^ and 2^nd^ centuries belonged on the \textgreek{υ} side of the \textgreek{οι}/\textgreek{υ} isogloss, the author has placed this city in the same position during the 3^rd^ cent.\ BCE. However, without further data or measurements as to the degree of such overrepresentation (and its potential effect), this placement is hypothetical and so represented with a dashed line on the map.

```{r map_4th_cen_oi, fig.width=7, fig.height=4, out.height="150%", fig.pos='H'}
#| fig-cap: "Fourth Century BCE Isogloss Line"

# Layer contour map
contour(elev,
        frame.plot = F,
        col = terrain.colors(n=10),
        xlab = "Latitude",
        ylab = "Longitude")
# Plot cities
points(
  x = cities$x,
  y = cities$y,
  col = "black",
  pch = 19,
  xlim = c(23, 24.5),
  ylim = c(37.5, 38.5)
)

# Define x-points for iso
oi_4th_x <- c(
  (cities[6,1] + cities[7,1])/2, # Control
  (cities[6,1] + cities[7,1])/2, # Tanagra v Oropos
  (cities[6,1] + cities[1,1])/2, # Tanagra v Athens
  (cities[6,1] + cities[2,1])/2, # Tanagra v Eleusis
  (cities[6,1] + cities[3,1])/2, # Tanagra v Megara
  (cities[6,1] + cities[4,1])/2, # Tanagra v Pagai
  (cities[6,1] + cities[5,1])/2  # Tanagra v Aigosthena
)

# Define y-points for iso
oi_4th_y <- c(
  ((cities[6,2] + cities[7,2])/2)+.05, # Control
  (cities[6,2] + cities[7,2])/2, # Tanagra v Oropos
  (cities[6,2] + cities[1,2])/2, # Tanagra v Athens
  (cities[6,2] + cities[2,2])/2, # Tanagra v Eleusis
  (cities[6,2] + cities[3,2])/2, # Tanagra v Megara
  (cities[6,2] + cities[4,2])/2, # Tanagra v Pagai
  (cities[6,2] + cities[5,2])/2  # Tanagra v Aigosthena
)

# Draw solid iso line to Pagai
lines(x = oi_4th_x[1:5], y = oi_4th_y[1:5], col = "blue", lwd = 2)
# Draw full dotted line
lines(x = oi_4th_x, y = oi_4th_y, col = "blue", lwd = 2, lty = 3)

# Label cities
# Moved to end so that iso lines wont overlap text
text(x = cities[-c(5,6),]$x,
     y = cities[-c(5,6),]$y,
     labels = cities[-c(5,6),]$names,
     col = "black",
     pos = 1)
text(x = cities[-c(1,2,3,4,7),]$x-.05,
     y = cities[-c(1,2,3,4,7),]$y,
     labels = cities[-c(1,2,3,4,7),]$names,
     col = "black",
     pos = 3
)
```

```{r map_3rd_cen_oi, fig.width=7, fig.height=4, out.height="150%", fig.pos='H'}
#| fig-cap: "Third Century BCE Isogloss Line"

# Layer contour map
contour(elev,
        frame.plot = F,
        col = terrain.colors(n=10),
        xlab = "Latitude",
        ylab = "Longitude")
# Plot cities
points(
  x = cities$x,
  y = cities$y,
  col = "black",
  pch = 19,
  xlim = c(23, 24.5),
  ylim = c(37.5, 38.5)
)

# Define x-points for iso
oi_3rd_x <- c(
  (cities[6,1] + cities[7,1])/2, # Control
  (cities[6,1] + cities[7,1])/2, # Tanagra v Oropos
  (cities[6,1] + cities[1,1])/2, # Tanagra v Athens
  (cities[6,1] + cities[2,1])/2, # Tanagra v Eleusis
  (cities[6,1] + cities[3,1])/2, # Tanagra v Megara
  (cities[6,1] + cities[4,1])/2, # Tanagra v Pagai
  (cities[6,1] + cities[5,1])/2  # Tanagra v Aigosthena
)

# Define y-points for iso
oi_3rd_y <- c(
  ((cities[6,2] + cities[7,2])/2)+.05, # Control
  (cities[6,2] + cities[7,2])/2, # Tanagra v Oropos
  (cities[6,2] + cities[1,2])/2, # Tanagra v Athens
  (cities[6,2] + cities[2,2])/2, # Tanagra v Eleusis
  (cities[6,2] + cities[3,2])/2, # Tanagra v Megara
  (cities[6,2] + cities[4,2])/2, # Tanagra v Pagai
  (cities[6,2] + cities[5,2])/2  # Tanagra v Aigosthena
)

# Draw dotted line
lines(x = oi_3rd_x, y = oi_3rd_y, col = "blue", lwd = 2, lty = 3)


# Label cities
# Moved to end so that iso lines wont overlap text
text(x = cities[-c(5,6),]$x,
     y = cities[-c(5,6),]$y,
     labels = cities[-c(5,6),]$names,
     col = "black",
     pos = 1)
text(x = cities[-c(1,2,3,4,7),]$x-.05,
     y = cities[-c(1,2,3,4,7),]$y,
     labels = cities[-c(1,2,3,4,7),]$names,
     col = "black",
     pos = 3
     )
```

```{r map_2nd_cen_oi, fig.width=7, fig.height=4, out.height="150%", fig.pos='t'}
#| fig-cap: "Second Century BCE Isogloss Line"

# Layer contour map
contour(elev,
        frame.plot = F,
        col = terrain.colors(n=10),
        xlab = "Latitude",
        ylab = "Longitude")
# Plot cities
points(
  x = cities$x,
  y = cities$y,
  col = "black",
  pch = 19,
  xlim = c(23, 24.5),
  ylim = c(37.5, 38.5)
)

# Define x-points for iso
oi_2nd_x <- c(
  (cities[6,1] + cities[7,1])/2, # Control
  (cities[6,1] + cities[7,1])/2, # Tanagra v Oropos
  (cities[6,1] + cities[1,1])/2, # Tanagra v Athens
  (cities[6,1] + cities[2,1])/2, # Tanagra v Eleusis
  (cities[6,1] + cities[3,1])/2, # Tanagra v Megara
  (cities[6,1] + cities[4,1])/2, # Tanagra v Pagai
  (cities[6,1] + cities[5,1])/2  # Tanagra v Aigosthena
)

# Define y-points for iso
oi_2nd_y <- c(
  ((cities[6,2] + cities[7,2])/2)+.05, # Control
  (cities[6,2] + cities[7,2])/2, # Tanagra v Oropos
  (cities[6,2] + cities[1,2])/2, # Tanagra v Athens
  (cities[6,2] + cities[2,2])/2, # Tanagra v Eleusis
  (cities[6,2] + cities[3,2])/2, # Tanagra v Megara
  (cities[6,2] + cities[4,2])/2, # Tanagra v Pagai
  (cities[6,2] + cities[5,2])/2  # Tanagra v Aigosthena
)

# Draw solid iso line to Pagai
lines(x = oi_2nd_x[1:5], y = oi_2nd_y[1:5], col = "blue", lwd = 2)
# Draw solid iso from Pagai to Aigosthena
lines(x = oi_2nd_x[6:7], y = oi_2nd_y[6:7], col = "blue", lwd = 2)
# Draw full dotted line
lines(x = oi_2nd_x, y = oi_2nd_y, col = "blue", lwd = 2, lty = 3)

# Label cities
# Moved to end so that iso lines wont overlap text
text(x = cities[-c(5,6),]$x,
     y = cities[-c(5,6),]$y,
     labels = cities[-c(5,6),]$names,
     col = "black",
     pos = 1)
text(x = cities[-c(1,2,3,4,7),]$x-.05,
     y = cities[-c(1,2,3,4,7),]$y,
     labels = cities[-c(1,2,3,4,7),]$names,
     col = "black",
     pos = 3
)
```
